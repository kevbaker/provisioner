#! /bin/bash

##
# A simple start/stop/restart/reload/force_stop NGINX script for the Provisioner project
# by Michael van Rooijen - https://github.com/meskyanichi/provisioner

##
# INSTALLATION
#
#  Place this file in /etc/init.d/nginx and chmod +x it to make it executable
#
# USAGE
#
#  /etc/init.d/nginx [start|stop|restart|reload|force_stop]
#

##
# Released under the "MIT LICENSE"

##
# Starts the NGINX web server
start() {
  echo "Starting NGINX!"
  nginx -c /etc/nginx/conf/nginx.conf
}

##
# Stops the NGINX web server
stop() {
  echo "Stopping NGINX!"
  kill -QUIT $(cat /etc/nginx/logs/nginx.pid)
}

##
# Restarts (by stopping and starting) the NGINX web server
restart() {
  echo "Restarting NGINX!"
  stop && sleep 1 && start
}

##
# Reloads the NGINX configuration file, gracefully shutting down the
# NGINX worker processes and starting them up again for the adjusted
# configuration to take effect
reload() {
  echo "Reloading NGINX!"
  kill -HUP $(cat /etc/nginx/logs/nginx.pid)
}

##
# Forces the NGINX process to shut down
force_stop() {
  echo "Force Quitting NGINX!"
  kill -TERM $(cat /etc/nginx/logs/nginx.pid)
}

$1
